using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace WinPlayer
{
    public static class FrequencyLookup
    {
        public static (double Frequency, bool Normal) Lookup(int noteNumber) =>  noteNumber switch
        {
            128 => (13289.75, false),
            127 => (12543.85, true),
            126 => (11839.82, false),
            125 => (11175.3, true),
            124 => (10548.08, true),
            123 => (9956.06, false),
            122 => (9397.27, true),
            121 => (8869.84, false),
            120 => (8372.02, true),
            119 => (7902.13, true),
            118 => (7458.62, false),
            117 => (7040, true),
            116 => (6644.88, false),
            115 => (6271.93, true),
            114 => (5919.91, false),
            113 => (5587.65, true),
            112 => (5274.04, true),
            111 => (4978.03, false),
            110 => (4698.64, true),
            109 => (4434.92, false),
            108 => (4186.01, true),
            107 => (3951.07, true),
            106 => (3729.31, false),
            105 => (3520, true),
            104 => (3322.44, false),
            103 => (3135.96, true),
            102 => (2959.96, false),
            101 => (2793.83, true),
            100 => (2637.02, true),
            99 => (2489.02, false),
            98 => (2349.32, true),
            97 => (2217.46, false),
            96 => (2093, true),
            95 => (1975.53, true),
            94 => (1864.66, false),
            93 => (1760, true),
            92 => (1661.22, false),
            91 => (1567.98, true),
            90 => (1479.98, false),
            89 => (1396.91, true),
            88 => (1318.51, true),
            87 => (1244.51, false),
            86 => (1174.66, true),
            85 => (1108.73, false),
            84 => (1046.5, true),
            83 => (987.77, true),
            82 => (932.33, false),
            81 => (880, true),
            80 => (830.61, false),
            79 => (783.99, true),
            78 => (739.99, false),
            77 => (698.46, true),
            76 => (659.26, true),
            75 => (622.25, false),
            74 => (587.33, true),
            73 => (554.37, false),
            72 => (523.25, true),
            71 => (493.88, true),
            70 => (466.16, false),
            69 => (440, false),
            68 => (415.3, false),
            67 => (392, true),
            66 => (369.99, false),
            65 => (349.23, true),
            64 => (329.63, true),
            63 => (311.13, false),
            62 => (293.66, true),
            61 => (277.18, false),
            60 => (261.63, false),
            59 => (246.94, true),
            58 => (233.08, false),
            57 => (220, true),
            56 => (207.65, false),
            55 => (196, true),
            54 => (185, false),
            53 => (174.61, true),
            52 => (164.81, true),
            51 => (155.56, false),
            50 => (146.83, true),
            49 => (138.59, false),
            48 => (130.81, true),
            47 => (123.47, true),
            46 => (116.54, false),
            45 => (110, true),
            44 => (103.83, false),
            43 => (98, true),
            42 => (92.5, false),
            41 => (87.31, true),
            40 => (82.41, true),
            39 => (77.78, false),
            38 => (73.42, true),
            37 => (69.3, false),
            36 => (65.41, true),
            35 => (61.74, true),
            34 => (58.27, false),
            33 => (55, true),
            32 => (51.91, false),
            31 => (49, true),
            30 => (46.25, false),
            29 => (43.65, true),
            28 => (41.2, true),
            27 => (38.89, false),
            26 => (36.71, true),
            25 => (34.65, false),
            24 => (32.7, true),
            23 => (30.87, true),
            22 => (29.14, false),
            21 => (27.5, true),

            _ => (0, false)
        };

        public static int FrequencyToVera(double frequency) => (int)(frequency / (48828.125 / Math.Pow(2, 17)));

        public static double VeraToFreqency(int vera) => vera * (48828.125 / Math.Pow(2, 17));

        public static double NoteStep(int noteNumber) => Lookup(noteNumber).Frequency / 6;
    }
}
